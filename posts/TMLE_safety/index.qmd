---
title: "Introduction for the Paper: Targeted Maximum Likelihood Estimation in Safety Analysis"
author: "Yujing Gao"
date: "2025-09-15"
categories: [safety analysis, Targeted maximum likelihood estimation, causal inference, doubly robust]
image: "paper_shot.png"
---

::: {style="text-align: justify;"}
## 1. Introduction

As pointed by this paper (Lendle; 2013), the health intervention a patient receives in observational studies is generally not assigned randomly but is chosen by the patient or physician based on characteristics of the patient. This paper focuses on two important questions:

-   When is it possible to estimate the effect of some health intervention on a safety or an effectiveness outcome without bias?

-   And if it is possible, how can we estimate the effect.

To address the first question, this paper discusses the potential outcomes framework and use it to formally define a target causal parameter that they wish to estimate and briefly review conditions under which it is possible to estimate the parameter without bias. 

To address the second question, this paper reviews common estimation methods including a method based on the G-computation formula, inverse probability of treatment weighting (IPTW), and propensity score (PS) matching, and compare them to doubly robust (DR) methods such as augmented IPTW (AIPTW), targeted maximum likelihood estimation (TMLE) and collaborative TMLE (CTMLE), an estimator that uses a data-adaptive estimate of the PS in collaboration with the outcome regression. 

Then they compare methods in a real data example, a simplified version of a drug safety surveillance study to motivate our question of interest and demonstrate the estimation methods.
The data set is a subset of data from Kaiser Permanente Northern California formatted according to the specification of Food and Drug Administration’s Mini-Sentinel drug safety surveillance program. 

In summary, the objective of this paper is to compare the performance of a targeted maximum likelihood estimator (TMLE) and a collaborative TMLE (CTMLE) to other estimators in a druf safety analysis, including a regression-based estimator, propensity score (PS)- based estimators, and an alternative doubly robust (DR) estimator in a real example and simulations.


## 2. Causal Parameter and Identifiability

Under the potential outcome framework (Rubin; 1974), define $Y(1)$ and $Y(0)$ as potential outcomes for a patient had the patient received treatment 1 or treatment 0 (placebo), respectively. The average treatment effect (ATE) is defined as $E[Y(1)-Y(0)]$, where $E$ denotes expectation with respect to the distribution of potential outcomes for the population of interest. For a particular patient, one of $Y(1)$ and $Y(0)$ is unobservable and is called counterfactual.

Define the observed data as $O = \{W,A,Y\}$, where $W$ represents baseline characteristics of a patient, $A=1$ if the patient receives the target treatment of interest or 0 if the patient receives the control treatment, and $Y$ is the patient's observed outcome. And assume that we can observe $n$ independent and identically distributed copies of $O$. 

To be able to estimate ATE, we need to write it as a function of the observed data distribution. If we can do this, they we say the ATE is **identifible**. Since the ATE depends on unobserved potential outcomes, identifiability in this paper requires the following assumption:

-   **Assumption 1 [Consistency]**:  $Y=AY(1) + (1-A)Y(0)$.

    -   This assumption means the observed outcome is the potential outcome under the treatment arm that patient actually received.

-   **Assumption 2 [Randomization]**:  $A \perp \{Y(0), Y(1)\} | W$.

      -   This assumption means that given a set of baseline covariates $W$, the treatment $A$ is independence of the potential outcomes $Y(0)$ and $Y(1)$. This is also called the "no unmeasured confounders" assumption.
 
-   **Assumption 3 [Positivity]**:  $0 < P(A=1|W) < 1$ for all $W$, where $P$ denotes probability.

      -   This assumption means for any value of baseline characteristics $W$, it is possible to receive either treatment.
      

Then under these assumptions, we can write 
$$E[Y(1) - Y(0)] = E[E(Y|A=1,W) - E(Y|A=0,W)] - \psi_0.$$
Thus, the ATE is equal to a statistical parameter that is a function of only the observed data distribution. 
    

## 3. Estimation

To estimate the causal effect, in addition to the randomization and positivity assumptions, we need to specify a statistical model or a set of possible probability distributions for the observed data $O$. A probability distribution for $O$ can be factorized into the distribution of $Y$ given $A$ and $W$, the distribution of $A$ given $W$, and the distribution of $W$. 

Traditional methods for estimating $\psi_0$ are usually based on an estimate of $E(Y|A,W)$, which we call the outcome regression, or are based on an estimate of the probability of being treated given baseline covariates, $P(A=1|W)$ , known as the propensity score (PS).

Next, we will introduce each estimation method provided in the paper.

## 3.1 G-computation Estimators



## 4. Data example

## Reference

-   S. D. Lendle, B. Fireman, and M. J. van der Laan. Targeted maximum likelihood estimation in safety analysis. J. Clin. Epidemiol., 66(8): S91–S98, 2013.
-   D. B. Rubin. Estimating causal effects of treatments in randomized and nonrandomized studies. J Educ Psychol, 66(5): 688--701, 1974.
:::
